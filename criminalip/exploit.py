from typing import Any
from criminalip.CriminalIP import Client


class Exploit(Client):
    def search(self, query: str, offset: int = 0) -> list[dict]:
        """API for searching exploit data with filter

        Args:
            query (str): Original searching text containing filters
            offset (int): Starting position in the dataset(entering in increments of 10)
        Returns:
            exploits (list[dict]): list of found Exploits
        TODO: pagination offset ?
        """
        params = {
            "query": query,
            "offset": offset,
        }
        result = self.request("GET", "exploit/search", params=params)
        exploits = result["data"]
        return exploits
